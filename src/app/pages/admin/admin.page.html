<ion-header translucent>
  <ion-toolbar color="primary">
    <ion-title>Pedido Nº{{dataParams.id}}</ion-title>
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()">
        <ion-icon name="arrow-round-back"></ion-icon>
        <small>Voltar</small>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card style="padding: 0;">
    <form [formGroup]="formCRUDPedido" fxLayoutAlign="column" *ngIf="pedidoId">
      <ion-item>
        <ion-col lines="none">
          <ion-item-group style="text-align: center; margin: 10px;">
            <ion-label style="padding-bottom: 5px;">Informações</ion-label>
            <ion-item-divider></ion-item-divider>
          </ion-item-group>
          <ion-row class="row">Forma Pagamento -> {{(pedido$ | async)?.formaPagamento?.descricao}}
          </ion-row>
          <ion-row class="row">Usuário -> {{(pedido$ | async)?.usuario?.nome}}
          </ion-row>
          <ion-row class="row">Observação -> {{(pedido$ | async)?.observacao}}
          </ion-row>
          <ion-row class="row">Troco -> R$ {{(pedido$ | async)?.troco}}
          </ion-row>
          <ion-item-divider></ion-item-divider>
          <ion-list *ngFor="let item of produtos$ | async">
            <ion-row>
              <ion-col class="row" style="max-width: 35px;">
                {{item.quantidade}}x
              </ion-col>
              <ion-col class="row">
                {{(item.produto)?.nome}}
              </ion-col>
              <ion-col class="row" style="text-align: end;">
                R$ {{(item.produto)?.preco}}
              </ion-col>
            </ion-row>
          </ion-list>
          <ion-list>
            <ion-item-divider></ion-item-divider>
            <ion-row>
              <ion-col class="row">
                Total
              </ion-col>
              <ion-col class="row" style="text-align: end;">
                R$ {{total}}
              </ion-col>
            </ion-row>
            <ion-row *ngIf="troco">
              <ion-col class="row">
                Troco
              </ion-col>
              <ion-col class="row" style="text-align: end;">
                R$ {{troco}}
              </ion-col>
            </ion-row>
          </ion-list>
        </ion-col>
      </ion-item>

      <ion-item style="margin-top: 20px;">
        <ion-col>
          <ion-item-group style="text-align: center; margin: 10px;">
            <ion-label style="padding-bottom: 5px;">Gerenciamento</ion-label>
            <ion-item-divider></ion-item-divider>
          </ion-item-group>
          <ion-item style="margin: 10px;">
            <ion-select formControlName="status_pedido_id" style="padding: 0; min-width: 100%;">
              <ion-select-option *ngFor="let status of (status$ | async)" [value]="status?.id">
                {{ status?.descricao }}</ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item style="margin: 10px;">
            <ion-label>Ativo</ion-label>
            <ion-toggle formControlName="ativo" (ionChange)="updateAtivoPedido(formCRUDPedido.get('ativo').value)">
            </ion-toggle>
          </ion-item>
          <ion-button [disabled]="!formCRUDPedido.valid" id="btnCriarConta" expand="full" (click)="onAtualizarPedido()">
            Atualizar
          </ion-button>
        </ion-col>
      </ion-item>

      <ion-item-group *ngIf="!moreInfo" style="margin-top: 20px;">
        <ion-button (click)="showMore()" expand="full">Mais Informações</ion-button>
      </ion-item-group>

      <ion-item *ngIf="(usuario$ | async)" style="margin-top: 20px;">
        <ion-col>
          <ion-item-group style="text-align: center; margin: 10px;">
            <ion-label style="padding-bottom: 5px;">Usuário</ion-label>
            <ion-item-divider></ion-item-divider>
            <ion-row class="rowUsuario">{{(usuario$ | async)?.id}}
            </ion-row>
            <ion-row class="rowUsuario">{{(usuario$ | async)?.nome}}
            </ion-row>
            <ion-row class="rowUsuario">{{(usuario$ | async)?.email}}
            </ion-row>
            <ion-row class="rowUsuario">{{(usuario$ | async)?.cpf}}
            </ion-row>
            <ion-row class="rowUsuario">{{(usuario$ | async)?.telefone}}
            </ion-row>
            <ion-row class="rowUsuario">{{(usuario$ | async)?.perfil?.descricao}}
            </ion-row>
          </ion-item-group>
          <form [formGroup]="formCRUDUsuario">
            <ion-item style="margin: 10px;">
              <ion-label>Ativo</ion-label>
              <ion-toggle formControlName="ativo" (ionChange)="updateAtivoUsuario(formCRUDUsuario.get('ativo').value)">
              </ion-toggle>
            </ion-item>
            <ion-button [disabled]="!formCRUDUsuario.valid" id="btnCriarConta" expand="full" (click)="onAtualizarUsuario()">
              Atualizar
            </ion-button>
          </form>
        </ion-col>
      </ion-item>

    </form>
  </ion-card>

  <!-- <pre>{{usuario$ | async | json}}</pre> -->

</ion-content>

<!-- <ion-card-content *ngIf="usuarioId">
          <form [formGroup]="formCRUD" fxLayoutAlign="column">
            <ion-input style="margin-right: 10px;" padding formControlName="nome" id="nome" class="input" type="text"
              placeholder="Nome" required></ion-input>
            <ion-input padding formControlName="telefone" id="telefone" class="input" type="string" placeholder="Telefone"
              [brmasker]="{phone: true}" required>
            </ion-input>
            <ion-input padding formControlName="cpf" id="cpf" class="input" type="string" placeholder="CPF"
              [brmasker]="{mask:'000.000.000-00', len:14}" required></ion-input>     
            <ion-input padding formControlName="email" id="email" class="input" type="email" placeholder="E-mail" required>
            </ion-input>
            <ion-input padding formControlName="password" id="password" class="input" type="password" placeholder="Senha"
              required>
            </ion-input>
          </form>
      
          <ion-button [disabled]="!formCRUD.valid" id="btnCriarConta" expand="full" (click)="onSaveUsuario()">Criar
          </ion-button>
        </ion-card-content> -->